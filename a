#!/bin/bash

# Script to add all changes, commit, and push to a Git repository

# Check if the Git repository is dirty (has changes)
if [[ -n $(git status -s) ]]; then
    # Add all changes
    git add .

    # Get the last commit message
    last_commit_message=$(git log --oneline --pretty=%B -n 1 | head -n 1)

    # Prompt whether to use the last commit message
    echo -n "Do you want to use the following previous commit message? (y/n):
    $last_commit_message
    Answer: "
    read use_previous_message

    if [[ $use_previous_message == "y" ]]; then
        commit_message=$last_commit_message
    else
        # Prompt for a new commit message
        echo -n "Enter a new commit message: "
        read commit_message
    fi

    # Commit changes with the provided message
    git commit -m "$commit_message"

    # Push changes to the default remote branch (e.g., 'main' or 'master')
    git push origin $(git symbolic-ref --short HEAD)
else
    echo "No changes to commit."
fi

